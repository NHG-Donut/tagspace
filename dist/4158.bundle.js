"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[4158],{23471:(e,o,n)=>{n.r(o),n.d(o,{default:()=>v});var t=n(74848),a=n(96488),r=n(87729),l=n(38291),s=n(10812),c=n(60341),i=n(45575),d=n(34120),p=n(16845),u=n(96984),h=n(91133),g=n(70704),m=n(4721),A=n(36749),f=n(69605),w=n(95124),x=n(55370),y=n(25418),j=n(49565),C=n(53356),k=n(22944),D=n(4213),L=n(96540),U=n(32389),b=n(69733);const v=function(e){const{open:o,onClose:n}=e,{t:v}=(0,U.Bd)(),I=(0,C.A)(),R=(0,k.A)(I.breakpoints.down("md")),{currentLocationId:T,findLocation:P,getFirstRWLocation:S}=(0,g.L)(),{setReflectActions:B}=(0,m.u)(),{downloadUrl:F}=(0,A.E)(),{showNotification:O}=(0,f.M)(),{openFileUploadDialog:E}=(0,u.m)(),W=(0,b.wA)(),{targetDirectoryPath:$}=(0,h.$)(),M=(0,L.useRef)(),[J,K]=(0,L.useState)(!1),N=(e,o,n)=>{W(w.o1.onUploadProgress(e,o,n))};function Y(){if(M.current){const e=T?P():S();try{const o=new URL(M.current);let t,r;if(J&&K(!1),o.pathname){const e=o.pathname.lastIndexOf("/");e>-1?(t=o.pathname.substring(e+1),t||(r=o.pathname.split("/").filter(Boolean))):t=o.pathname}t?-1===t.indexOf(".")&&(t=o.hostname+"-"+t+".html"):t=o.hostname+(r&&r.length>0?r.join("-"):"")+".html",!e.haveObjectStoreSupport()&&a.A.isElectron?(W(w.o1.resetProgress()),E(),F(M.current,$+"/"+decodeURIComponent(t),N).then(e=>{B({action:"add",entry:e,open:!0,source:"upload"})}).catch(e=>{console.log("downloadFile error:",e),W(w.o1.setProgress(M.current,-1,v("core:errorCORS"))),O("downloadFile error"+e.message,"error",!0)})):(0,D.saveAs)(M.current,decodeURIComponent(t)),n()}catch(e){K(!0),console.log("downloadURL",e)}}}const _=(0,t.jsx)(l.A,{variant:"contained","data-tid":"downloadFileUrlTID",onClick:()=>Y(),style:{WebkitAppRegion:"no-drag"},children:v("core:ok")});return(0,t.jsx)(p.J,{children:(0,t.jsxs)(x.A,{open:o,onClose:n,fullScreen:R,keepMounted:!0,"aria-labelledby":"draggable-dialog-title",PaperComponent:R?j.A:r.A,scroll:"paper",children:[(0,t.jsx)(d.A,{dialogTitle:v("core:downloadLink"),closeButtonTestId:"closeDownloadURLDialogTID",onClose:n,actionSlot:_}),(0,t.jsxs)(y.A,{style:{minWidth:200,marginBottom:20,overflow:"overlay"},"data-tid":"downloadUrlDialogTID",children:[(0,t.jsx)(s.A,{error:J,label:v("core:url"),autoFocus:!0,name:"name","data-tid":"newUrlTID",onKeyDown:e=>{"Enter"===e.key&&Y()},onChange:e=>{M.current=e.target.value}}),(0,t.jsx)(c.A,{})]}),!R&&(0,t.jsxs)(i.A,{children:[(0,t.jsx)(l.A,{onClick:n,children:v("core:cancel")}),_]})]})})}},60341:(e,o,n)=>{n.d(o,{A:()=>p});var t=n(74848),a=n(32535),r=n(91133),l=n(70704),s=n(85342),c=n(35124),i=n(67172),d=n(32389);const p=function(){const{t:e}=(0,d.Bd)(),{findLocation:o}=(0,l.L)(),{targetDirectoryPath:n}=(0,r.$)(),p=o();return(0,t.jsx)(s.A,{container:!0,style:{marginTop:20},children:n?(0,t.jsxs)(c.A,{style:{display:"flex",alignItems:"center"},variant:"caption",children:[(0,t.jsx)(a.mo,{style:{paddingRight:10}}),e("core:entriesWillBeCreatedIn")+" "+(p?.type===i.locationType.TYPE_CLOUD?p.name+"/":"")+n]}):(0,t.jsx)(c.A,{variant:"caption",children:e("noSuitableLocation")})})}},91133:(e,o,n)=>{n.d(o,{$:()=>r});var t=n(96540),a=n(16845);const r=()=>(0,t.useContext)(a.O)}}]);
//# sourceMappingURL=4158.bundle.js.map