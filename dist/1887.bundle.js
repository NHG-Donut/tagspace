/*! For license information please see 1887.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[1887],{3936:(e,t,n)=>{n.d(t,{v:()=>s});var i=n(96540),o=n(20797),r=n(45231);function s(e,t,n,s){(0,i.useImperativeHandle)(e,()=>({update:e=>{const t=n();!s&&t&&t.status===r.qv.Created&&t.action((0,o.yh)(e))},insert:e=>{const t=n();!s&&t&&t.status===r.qv.Created&&t.action((0,o.Yr)(e))},setEditMode:e=>{const i=t(),o=n();i&&o&&i.setReadonly(!e)},getMarkdown:()=>{const e=n();if(!s&&e&&e.status===r.qv.Created)return e.action((0,o.up)())},destroy:()=>{const e=t();e&&e.destroy()}}))}},6868:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(16290),o=n(74848);const r=(0,i.A)((0,o.jsx)("path",{d:"m9.03 3-1.11 7.07h2.62l.7-4.5h2.58L11.8 18.43H9.47L9.06 21h7.27l.4-2.57h-2.35l2-12.86h2.58l-.71 4.5h2.65L22 3zM8 5H4l-.31 2h4zm-.61 4h-4l-.31 2h4zm.92 8h-6L2 19h6zm.62-4h-6l-.31 2h6.01z"}),"Rtt")},13868:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var i=n(74848),o=n(96488),r=n(32535),s=n(41244),a=n(38291),d=n(7544),c=n(30880),l=n(40696),p=n(96540),h=n(51475),u=n(37603),m=n(12070),f=n(32389),v=n(87653),g=n(6868);const x=function(e){const{t}=(0,f.Bd)(),{anchorEl:n,handleClose:o,saveAsHtml:r,saveAsMarkdown:s}=e;return(0,i.jsxs)(h.A,{anchorEl:n,id:"description-menu",open:Boolean(n),onClose:o,onClick:o,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[(0,i.jsxs)(u.A,{onClick:r,children:[(0,i.jsx)(m.A,{children:(0,i.jsx)(v.A,{fontSize:"small"})}),t("core:saveAsHtml")]}),(0,i.jsxs)(u.A,{onClick:s,children:[(0,i.jsx)(m.A,{children:(0,i.jsx)(g.A,{fontSize:"small"})}),t("core:saveAsMd")]})]})};var A=n(70704),y=n(4337),C=n(22013),D=n(19825),j=n(2788),b=n(53356),w=n(73514),M=n(58760),R=n(67172),E=n(77118);const B=({getHtml:e,resetMdContent:t,setEditMode:n})=>{const{t:h}=(0,f.Bd)(),{saveDescription:u,isEditMode:m,isDescriptionChanged:v,isEditDescriptionMode:g,setEditDescriptionMode:B}=(0,y.o)(),{findLocation:k}=(0,A.L)(),{openedEntry:T,reloadOpenedFile:H}=(0,C.s)(),[S,L]=p.useState(null),I=(0,b.A)(),z=v?(0,i.jsx)(w.A,{title:h("core:fileChanged"),children:(0,i.jsx)("span",{"data-tid":"descriptionChangedTID",style:{color:I.palette.text.primary,marginLeft:3,marginTop:-2},children:String.fromCharCode(9679)})}):null;return(0,i.jsxs)("div",{style:{marginBottom:o.A.defaultSpaceBetweenButtons,whiteSpace:"nowrap",overflowX:"auto",overflowY:"hidden",alignItems:"center",display:"flex"},children:[(0,i.jsxs)(M.A,{children:[g&&(0,i.jsx)(a.A,{style:{borderTopRightRadius:0,borderBottomRightRadius:0},onClick:()=>{t(T.meta?.description),n(!1),B(!1)},children:h("core:cancel")}),(0,i.jsx)(s.dH,{tooltip:!g&&h("editDescription"),children:(0,i.jsx)(a.A,{"data-tid":g?"saveDescriptionTID":"editDescriptionTID",disabled:!D.C||k(T.locationID)?.isReadOnly,style:{borderTopLeftRadius:g?0:o.A.defaultCSSRadius,borderBottomLeftRadius:g?0:o.A.defaultCSSRadius,whiteSpace:"nowrap"},onClick:()=>{g?u().then(()=>{v||n(!1),B(!1)}):(n(!0),B(!0))},children:g?(0,i.jsxs)(i.Fragment,{children:[h("core:confirmSaveButton")," ",z]}):h("core:editDescription")})})]}),(0,i.jsx)(s.dH,{tooltip:"Add AI generated description based on the file content",children:(0,i.jsx)(c.A,{style:{marginLeft:o.A.defaultSpaceBetweenButtons},variant:"outlined"})}),T.meta?.description&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)(s.dH,{tooltip:"Add AI generated tags based on the description",children:(0,i.jsx)(l.A,{style:{marginLeft:o.A.defaultSpaceBetweenButtons},fromDescription:!0,variant:"outlined"})})}),(0,i.jsx)(d.A,{tooltip:h("core:chatMore"),onClick:e=>{L(e.currentTarget)},style:{marginLeft:o.A.defaultSpaceBetweenButtons},"data-tid":"chatMoreTID","aria-label":h("core:chatMore"),"aria-controls":Boolean(S)?"account-menu":void 0,"aria-haspopup":"true","aria-expanded":Boolean(S)?"true":void 0,children:(0,i.jsx)(r.wc,{})}),(0,i.jsx)(x,{anchorEl:S,handleClose:()=>{L(null)},saveAsHtml:()=>{L(null);const t=e();if(t){const e=new Blob([t],{type:"text/html"}),n=(0,R.formatDateTime4Tag)(new Date,!0),i=(0,E.extractTitle)(T.name)+" [description "+n+"].html";(0,j.Nk)(e,i)}},saveAsMarkdown:()=>{if(L(null),T.meta?.description){const e=new Blob([T.meta.description],{type:"text/markdown"}),t=(0,R.formatDateTime4Tag)(new Date,!0),n=(0,E.extractTitle)(T.name)+" [description "+t+"].md";(0,j.Nk)(e,n)}}})]})};var k=n(92339),T=n(45231),H=n(20797),S=n(4120),L=n(14562),I=n(62231),z=n(3936),F=n(62796);const q=(0,p.forwardRef)((e,t)=>{const{onFocus:n}=e,{t:o}=(0,f.Bd)(),{currentDirectoryPath:r}=(0,L.L)(),{metaActions:s}=(0,S.B)(),{saveDescription:a,isEditDescriptionMode:d,isDescriptionChanged:c,description:l,setDescription:h}=(0,y.o)(),{openedEntry:u,openLink:m}=(0,C.s)(),v=(0,p.useRef)(null),g=(0,F.A)(),{get:x,loading:A}=(0,k.hG)(e=>{const t=d?void 0:o(D.C?"core:addMarkdownDescription":"core:thisFunctionalityIsAvailableInPro"),i=(0,I.T)(e,l,d,{},t,r,m,e=>{h(e)},n);i.editor.onStatusChange(e=>{e===T.qv.Created&&(v.current=i)});const s=(0,H.yu)("saveCommand",()=>()=>()=>(a(),!0)),c=(0,H.pq)("saveKeymap",{saveDescription:{shortcuts:"Mod-s",command:e=>{const t=e.get(T.MD);return()=>t.call(s.key)}}});return i.editor.use([s,c].flat()),i},[r]);function j(e){const t=v.current;if(!A&&t&&t.editor.status===T.qv.Created)try{t.editor.action((0,H.up)())!==e&&t.editor.action((0,H.yh)(e,!0))}catch(e){console.error("Failed to replaceAll:",e)}}return(0,p.useEffect)(()=>{c||j(u.meta?.description??"")},[u]),(0,p.useEffect)(()=>{const e=v.current;if(!A&&e&&e.editor.status===T.qv.Created)try{e.setReadonly(!d)}catch(e){console.error("Failed to setReadonly:",e)}},[d]),(0,p.useEffect)(()=>{if(!g&&s&&s.length>0)for(const e of s)e.entry&&u.path===e.entry.path&&"descriptionChange"===e.action&&j(e.entry.meta?.description??"")},[s]),(0,z.v)(t,()=>v.current,x,A),(0,i.jsx)(k.y5,{})}),V=function(){const e=(0,b.A)(),{setEditDescriptionMode:t}=(0,y.o)(),n=(0,p.useRef)(null),r=(0,p.useRef)(null);(0,p.useEffect)(()=>()=>{r.current?.destroy()},[]);const s=e=>{r.current&&r.current.setEditMode(e)};return(0,i.jsxs)("div",{style:{height:"calc(100% - 50px)"},children:[(0,i.jsx)(B,{getHtml:()=>n.current?.innerHTML,resetMdContent:e=>{r.current&&r.current.update(e)},setEditMode:s}),(0,i.jsxs)("div",{ref:n,className:"descriptionEditor","data-tid":"descriptionTID",onDoubleClick:()=>{D.C&&(t(!0),s(!0))},style:{border:"1px solid lightgray",borderRadius:o.A.defaultCSSRadius,height:"calc(100% - 20px)",width:"100%",overflowY:"auto"},children:[(0,i.jsx)("style",{children:`.descriptionEditor .milkdown .ProseMirror {\n              padding: 10px 30px 10px 80px;\n          }\n          .descriptionEditor .prose a {\n              color: ${e.palette.primary.main};\n          }\n          .descriptionEditor .prose img {\n              max-width: 99%;\n          }`}),(0,i.jsx)(k.pb,{children:(0,i.jsx)(q,{ref:r})})]})]})}},30880:(e,t,n)=>{n.d(t,{A:()=>y});var i=n(74848),o=n(38291),r=n(13923),s=n(66530),a=n(71872),d=n(70704),c=n(4337),l=n(36749),p=n(69605),h=n(22013),u=n(19825),m=n(14970),f=n(58760),v=n(96540),g=n(32389),x=n(69733),A=n(32535);const y=function(e){const{style:t}=e,{t:n}=(0,g.Bd)(),y=(0,x.wA)(),{findLocation:C}=(0,d.L)(),{openedEntry:D}=(0,h.s)(),{setDescriptionChange:j}=(0,l.E)(),{descriptionGenerate:b}=(0,a.v)(),{setDescription:w,saveDescription:M}=(0,c.o)(),{showNotification:R}=(0,p.M)(),{openAiGenerationDialog:E}=(0,r.P)(),[B,k]=(0,v.useState)(!1),T=(0,x.d4)(m.n_),H=B||!u.C||!T;if(!D||!D.isFile||C(D.locationID)?.isReadOnly)return null;const S=e=>{e&&R("Description for "+D.name+" generated by an AI.")};return(0,i.jsxs)(f.A,{style:{...t},children:[(0,i.jsx)(o.A,{loading:B,disabled:H,"data-tid":"generateDescriptionAITID",style:{borderTopRightRadius:0,borderBottomRightRadius:0},onClick:()=>{k(!0),b(D).then(e=>function(e){if(k(!1),e)return e.uuid===D.uuid?(y(m.o1.setEntryContainerTab(s.ob.descriptionTab)),w(e.meta?.description),M().then(S)):j(e,e.meta?.description).then(S)}(e))},children:n("core:generateDescription")}),(0,i.jsx)(o.A,{disabled:H,"aria-label":n("core:openGenSettings"),"data-tid":"fileContainerPrevFile",onClick:()=>{E("summary",[D])},style:{borderTopLeftRadius:0,borderBottomLeftRadius:0},children:(0,i.jsx)(A.Aq,{fontSize:"small"})})]})}},87653:(e,t,n)=>{n.d(t,{A:()=>r});var i=n(16290),o=n(74848);const r=(0,i.A)((0,o.jsx)("path",{d:"M3.5 9H5v6H3.5v-2.5h-2V15H0V9h1.5v2h2zm14 0H13c-.55 0-1 .45-1 1v5h1.5v-4.5h1V14H16v-3.51h1V15h1.5v-5c0-.55-.45-1-1-1M11 9H6v1.5h1.75V15h1.5v-4.5H11zm13 6v-1.5h-2.5V9H20v6z"}),"Html")}}]);
//# sourceMappingURL=1887.bundle.js.map