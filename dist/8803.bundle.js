"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[8803],{97340:(e,t,o)=>{o.r(t),o.d(t,{default:()=>ve});var n=o(74848),a=o(96540),i=o(77118),s=o(80467),r=o(37170),l=o(7544),c=o(96488),d=o(49565),u=o(34164),p=o(21362),h=o(26739),g=o(39241),m=o(13202),x=o(79844),A=o(37603),b=o(55415),f=o(94963),w=o(96224),P=o(411),v=o(56536),y=o(1883),I=o(32483),j=o(98600),B=o(48390),T=o(96148),R=o(1908);function C(e){return(0,R.Ay)("MuiTablePaginationActions",e)}(0,T.A)("MuiTablePaginationActions",["root"]);const k=(0,h.Ay)("div",{name:"MuiTablePaginationActions",slot:"Root"})({}),M=a.forwardRef(function(e,t){const o=(0,m.b)({props:e,name:"MuiTablePaginationActions"}),{backIconButtonProps:a,className:i,count:s,disabled:r=!1,getItemAriaLabel:l,nextIconButtonProps:c,onPageChange:d,page:h,rowsPerPage:g,showFirstButton:x,showLastButton:A,slots:b={},slotProps:f={},...w}=o,T=(0,P.I)(),R=(e=>{const{classes:t}=e;return(0,p.A)({root:["root"]},C,t)})(o),M=b.firstButton??I.A,S=b.lastButton??I.A,D=b.nextButton??I.A,F=b.previousButton??I.A,L=b.firstButtonIcon??B.A,E=b.lastButtonIcon??j.A,N=b.nextButtonIcon??y.A,H=b.previousButtonIcon??v.A,$=T?S:M,W=T?D:F,O=T?F:D,G=T?M:S,z=T?f.lastButton:f.firstButton,V=T?f.nextButton:f.previousButton,Y=T?f.previousButton:f.nextButton,U=T?f.firstButton:f.lastButton;return(0,n.jsxs)(k,{ref:t,className:(0,u.A)(R.root,i),...w,children:[x&&(0,n.jsx)($,{onClick:e=>{d(e,0)},disabled:r||0===h,"aria-label":l("first",h),title:l("first",h),...z,children:T?(0,n.jsx)(E,{...f.lastButtonIcon}):(0,n.jsx)(L,{...f.firstButtonIcon})}),(0,n.jsx)(W,{onClick:e=>{d(e,h-1)},disabled:r||0===h,color:"inherit","aria-label":l("previous",h),title:l("previous",h),...V??a,children:T?(0,n.jsx)(N,{...f.nextButtonIcon}):(0,n.jsx)(H,{...f.previousButtonIcon})}),(0,n.jsx)(O,{onClick:e=>{d(e,h+1)},disabled:r||-1!==s&&h>=Math.ceil(s/g)-1,color:"inherit","aria-label":l("next",h),title:l("next",h),...Y??c,children:T?(0,n.jsx)(H,{...f.previousButtonIcon}):(0,n.jsx)(N,{...f.nextButtonIcon})}),A&&(0,n.jsx)(G,{onClick:e=>{d(e,Math.max(0,Math.ceil(s/g)-1))},disabled:r||h>=Math.ceil(s/g)-1,"aria-label":l("last",h),title:l("last",h),...U,children:T?(0,n.jsx)(L,{...f.firstButtonIcon}):(0,n.jsx)(E,{...f.lastButtonIcon})})]})});var S=o(54587);function D(e){return(0,R.Ay)("MuiTablePagination",e)}const F=(0,T.A)("MuiTablePagination",["root","toolbar","spacer","selectLabel","selectRoot","select","selectIcon","input","menuItem","displayedRows","actions"]);var L,E=o(85078);const N=(0,h.Ay)(f.A,{name:"MuiTablePagination",slot:"Root"})((0,g.A)(({theme:e})=>({overflow:"auto",color:(e.vars||e).palette.text.primary,fontSize:e.typography.pxToRem(14),"&:last-child":{padding:0}}))),H=(0,h.Ay)(w.A,{name:"MuiTablePagination",slot:"Toolbar",overridesResolver:(e,t)=>({[`& .${F.actions}`]:t.actions,...t.toolbar})})((0,g.A)(({theme:e})=>({minHeight:52,paddingRight:2,[`${e.breakpoints.up("xs")} and (orientation: landscape)`]:{minHeight:52},[e.breakpoints.up("sm")]:{minHeight:52,paddingRight:2},[`& .${F.actions}`]:{flexShrink:0,marginLeft:20}}))),$=(0,h.Ay)("div",{name:"MuiTablePagination",slot:"Spacer"})({flex:"1 1 100%"}),W=(0,h.Ay)("p",{name:"MuiTablePagination",slot:"SelectLabel"})((0,g.A)(({theme:e})=>({...e.typography.body2,flexShrink:0}))),O=(0,h.Ay)(b.A,{name:"MuiTablePagination",slot:"Select",overridesResolver:(e,t)=>({[`& .${F.selectIcon}`]:t.selectIcon,[`& .${F.select}`]:t.select,...t.input,...t.selectRoot})})({color:"inherit",fontSize:"inherit",flexShrink:0,marginRight:32,marginLeft:8,[`& .${F.select}`]:{paddingLeft:8,paddingRight:24,textAlign:"right",textAlignLast:"right"}}),G=(0,h.Ay)(A.A,{name:"MuiTablePagination",slot:"MenuItem"})({}),z=(0,h.Ay)("p",{name:"MuiTablePagination",slot:"DisplayedRows"})((0,g.A)(({theme:e})=>({...e.typography.body2,flexShrink:0})));function V({from:e,to:t,count:o}){return`${e}â€“${t} of ${-1!==o?o:`more than ${t}`}`}function Y(e){return`Go to ${e} page`}const U=a.forwardRef(function(e,t){const o=(0,m.b)({props:e,name:"MuiTablePagination"}),{ActionsComponent:i=M,backIconButtonProps:s,colSpan:r,component:l=f.A,count:c,disabled:d=!1,getItemAriaLabel:h=Y,labelDisplayedRows:g=V,labelRowsPerPage:A="Rows per page:",nextIconButtonProps:b,onPageChange:w,onRowsPerPageChange:P,page:v,rowsPerPage:y,rowsPerPageOptions:I=[10,25,50,100],SelectProps:j={},showFirstButton:B=!1,showLastButton:T=!1,slotProps:R={},slots:C={},...k}=o,F=o,U=(e=>{const{classes:t}=e;return(0,p.A)({root:["root"],toolbar:["toolbar"],spacer:["spacer"],selectLabel:["selectLabel"],select:["select"],input:["input"],selectIcon:["selectIcon"],menuItem:["menuItem"],displayedRows:["displayedRows"],actions:["actions"]},D,t)})(F),q=R?.select??j,J=q.native?"option":G;let K;l!==f.A&&"td"!==l||(K=r||1e3);const Q=(0,S.A)(q.id),X=(0,S.A)(q.labelId),Z={slots:C,slotProps:R},[_,ee]=(0,E.A)("root",{ref:t,className:U.root,elementType:N,externalForwardedProps:{...Z,component:l,...k},ownerState:F,additionalProps:{colSpan:K}}),[te,oe]=(0,E.A)("toolbar",{className:U.toolbar,elementType:H,externalForwardedProps:Z,ownerState:F}),[ne,ae]=(0,E.A)("spacer",{className:U.spacer,elementType:$,externalForwardedProps:Z,ownerState:F}),[ie,se]=(0,E.A)("selectLabel",{className:U.selectLabel,elementType:W,externalForwardedProps:Z,ownerState:F,additionalProps:{id:X}}),[re,le]=(0,E.A)("select",{className:U.select,elementType:O,externalForwardedProps:Z,ownerState:F}),[ce,de]=(0,E.A)("menuItem",{className:U.menuItem,elementType:J,externalForwardedProps:Z,ownerState:F}),[ue,pe]=(0,E.A)("displayedRows",{className:U.displayedRows,elementType:z,externalForwardedProps:Z,ownerState:F});return(0,n.jsx)(_,{...ee,children:(0,n.jsxs)(te,{...oe,children:[(0,n.jsx)(ne,{...ae}),I.length>1&&(0,n.jsx)(ie,{...se,children:A}),I.length>1&&(0,n.jsx)(re,{variant:"standard",...!q.variant&&{input:L||(L=(0,n.jsx)(x.Ay,{}))},value:y,onChange:P,id:Q,labelId:X,...q,classes:{...q.classes,root:(0,u.A)(U.input,U.selectRoot,(q.classes||{}).root),select:(0,u.A)(U.select,(q.classes||{}).select),icon:(0,u.A)(U.selectIcon,(q.classes||{}).icon)},disabled:d,...le,children:I.map(e=>(0,a.createElement)(ce,{...de,key:e.label?e.label:e,value:e.value?e.value:e},e.label?e.label:e))}),(0,n.jsx)(ue,{...pe,children:g({from:0===c?0:v*y+1,to:-1===c?(v+1)*y:-1===y?c:Math.min(c,(v+1)*y),count:-1===c?-1:c,page:v})}),(0,n.jsx)(i,{className:U.actions,backIconButtonProps:s,count:c,nextIconButtonProps:b,onPageChange:w,page:v,rowsPerPage:y,showFirstButton:B,showLastButton:T,slotProps:R.actions,slots:C.actions,getItemAriaLabel:h,disabled:d})]})})});var q=o(96120),J=o(54026),K=o(80625);function Q(e){return(0,R.Ay)("MuiTableHead",e)}(0,T.A)("MuiTableHead",["root"]);const X=(0,h.Ay)("thead",{name:"MuiTableHead",slot:"Root"})({display:"table-header-group"}),Z={variant:"head"},_="thead",ee=a.forwardRef(function(e,t){const o=(0,m.b)({props:e,name:"MuiTableHead"}),{className:a,component:i=_,...s}=o,r={...o,component:i},l=(e=>{const{classes:t}=e;return(0,p.A)({root:["root"]},Q,t)})(r);return(0,n.jsx)(K.A.Provider,{value:Z,children:(0,n.jsx)(X,{as:i,className:(0,u.A)(l.root,a),ref:t,role:i===_?null:"rowgroup",ownerState:r,...s})})});var te=o(78828),oe=o(51361),ne=o(19825),ae=o(32535),ie=o(87729),se=o(41873),re=o(34120),le=o(70704),ce=o(4337),de=o(22013),ue=o(14970),pe=o(35124),he=o(55370),ge=o(25418),me=o(53356),xe=o(22944),Ae=o(69733);const be=function(e){const{open:t=!1,onClose:o,fsEntry:s}=e,{findLocation:r}=(0,le.L)(),{openedEntry:l}=(0,de.s)(),{isEditMode:d}=(0,ce.o)(),u=(0,me.A)(),p=(0,xe.A)(u.breakpoints.down("md")),h=((0,Ae.d4)(ue.j1),(0,a.useRef)(null)),g=(0,a.useRef)(null),m=s&&l?{...l,...s.uuid&&{uuid:s.uuid},path:s.path,isFile:s.isFile}:void 0;function x(e){const t=r(m.locationID);return t?.loadTextFilePromise(m.path,e).then(e=>e.startsWith("\ufeff")?e.slice(1):e).catch(e=>{console.log("Error loading text content "+e)})}return s?(0,n.jsxs)(he.A,{open:t,onClose:o,keepMounted:!0,scroll:"paper",fullWidth:!0,maxWidth:"md",fullScreen:p,"aria-labelledby":"draggable-dialog-title",PaperComponent:ie.A,PaperProps:{sx:{width:"100%",height:"100%"}},slotProps:{backdrop:{style:{backgroundColor:"transparent"}}},children:[(0,n.jsx)(re.A,{dialogTitle:"Preview",closeButtonTestId:"closeFilePreviewTID",onClose:o}),(0,n.jsxs)(ge.A,{style:{marginLeft:"auto",marginRight:"auto",overflowY:"hidden",padding:p?"0":"inherited",flexGrow:1},"data-tid":"filePreviewTID",children:[(0,n.jsx)(pe.A,{variant:"body2",gutterBottom:!0,style:{wordBreak:"break-all",margin:10},children:s.path}),(0,n.jsx)(se.A,{fileViewer:h,fileViewerContainer:g,height:"90%",handleMessage:e=>{if(m&&m.path)switch(e.command){case"loadDefaultTextContent":x(!!e.preview&&e.preview).then(e=>{if(h&&h.current&&h.current.contentWindow&&h.current.contentWindow.setContent){let t=(0,i.extractContainingDirectoryPath)(m.path);if(c.A.isWeb){const e=(0,i.extractContainingDirectoryPath)(location.href);t=(e&&"/"!==e?e+"/":"")+t}h.current.contentWindow.setContent(e,t,!d,u.palette.mode)}});break;case"parentLoadTextContent":x(!!e.preview&&e.preview).then(e=>{h?.current?.contentWindow?.postMessage({action:"fileContent",content:e,isEditMode:d},"*")})}}},"FileViewPreviewID")]})]}):null};var fe=o(32389),we=o(45387),Pe=o(36749);const ve=function(){const{t:e}=(0,fe.Bd)(),{findLocation:t}=(0,le.L)(),{getMetadataID:o}=(0,Pe.E)(),{openedEntry:u,reloadOpenedFile:p}=(0,de.s)(),{copyFilePromiseOverwrite:h,deleteEntriesPromise:g}=(0,we.U)(),[m,x]=(0,a.useState)([]),[A,b]=(0,a.useState)(0),[w,P]=a.useState(10),[v,y]=(0,a.useState)(void 0);function I(e){return parseInt((0,i.extractFileNameWithoutExt)(e))}function j(e){if(ne.C){const n=t(e.locationID);n&&o(e.path,e.uuid,n).then(t=>{const o=(0,i.getBackupFileLocation)(e.path,t,n.getDirSeparator()),a=(0,i.extractContainingDirectoryPath)(o,n.getDirSeparator());n.listDirectoryPromise(a,[]).then(e=>{x(e.sort((e,t)=>I(e.name)<I(t.name)?1:-1))})})}}function B(e){return e?(0,r.m)(e,{includeSeconds:!0,addSuffix:!0}):""}(0,a.useEffect)(()=>{u&&-1===u.path.indexOf(c.A.metaFolder)&&j(u)},[u]);const T=a.useMemo(()=>m.slice(A*w,A*w+w),[m,A,w]);return(0,n.jsxs)(d.A,{sx:{width:"100%",overflow:"hidden",height:"100%"},children:[m.length>10&&(0,n.jsx)(U,{rowsPerPageOptions:[10,25],component:"div",count:m.length,rowsPerPage:w,page:A,onPageChange:(e,t)=>{b(t)},onRowsPerPageChange:e=>{P(parseInt(e.target.value,10)),b(0)}}),(0,n.jsx)(q.A,{component:d.A,sx:{maxHeight:"100%",overflowY:"auto"},children:(0,n.jsxs)(J.A,{"data-tid":"tableRevisionsTID",sx:{width:"100%",height:"100%"},stickyHeader:!0,size:"small","aria-label":"revisions table",children:[(0,n.jsx)(ee,{children:(0,n.jsxs)(te.A,{children:[(0,n.jsxs)(f.A,{children:[e("revisions"),(0,n.jsx)(l.A,{tooltip:e("core:deleteAllRevisions"),"aria-label":"delete all revisions",onClick:()=>window.confirm("The all revisions will be deleted. Do you want to continue?")&&function(){if(m.length>0){const e=t(u.locationID);g(...m.map(t=>e.toFsEntry(t.path,t.isFile))).then(()=>j(u))}}(),"data-tid":"deleteRevisionsTID",children:(0,n.jsx)(ae.d7,{})})]}),(0,n.jsx)(f.A,{align:"right",children:e("created")}),(0,n.jsx)(f.A,{align:"right",children:e("actions")})]})}),(0,n.jsx)(oe.A,{children:T.map(o=>{return(0,n.jsxs)(te.A,{"data-tid":u.uuid,sx:{"&:last-child td, &:last-child th":{border:0}},children:[(0,n.jsx)(f.A,{component:"th",scope:"row",onClick:()=>y(o),children:o.name}),(0,n.jsx)(f.A,{align:"right",title:(a=o.lmdt,a?(0,s.GP)(a,"dd.MM.yyyy HH:mm:ss"):""),children:B(I(o.name))}),(0,n.jsxs)(f.A,{align:"right",children:[(0,n.jsx)(l.A,{tooltip:e("core:view"),"aria-label":"view revision",onClick:()=>y(o),"data-tid":"viewRevisionTID",children:(0,n.jsx)(ae.cy,{})}),(0,n.jsx)(l.A,{tooltip:e("core:restore"),"aria-label":"restore revision",onClick:()=>function(e){const o=t(u.locationID),n=(0,i.getBackupFileLocation)(u.path,u.uuid,o.getDirSeparator());return h(u.path,n).then(()=>h(e,u.path).then(()=>p()))}(o.path),"data-tid":"restoreRevisionTID",children:(0,n.jsx)(ae.G2,{})}),(0,n.jsx)(l.A,{tooltip:e("core:delete"),"aria-label":"delete revision",onClick:()=>function(e){const o=t(u.locationID);g(o.toFsEntry(e,!0)).then(()=>j(u))}(o.path),"data-tid":"deleteRevisionTID",children:(0,n.jsx)(ae.d7,{})})]})]},o.path);var a})})]})}),(0,n.jsx)(be,{fsEntry:v,open:void 0!==v,onClose:()=>y(void 0)})]})}}}]);
//# sourceMappingURL=8803.bundle.js.map