"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[6809],{40299:(e,t,n)=>{n.r(t),n.d(t,{default:()=>W});var r=n(74848),a=n(96488),l=n(74120),i=n(87729),o=n(38291),c=n(10812),d=n(91133),s=n(2788),u=n(62796),f=n(91799),p=n(58760),h=n(87714),g=n(85342),m=n(96540),x=n(32389);const T=function(e){const{tidPrefix:t,fileType:n,createFile:a,fileName:l,fileContent:i,handleFileNameChange:T,handleFileContentChange:C,haveError:v}=e,{t:A}=(0,x.Bd)(),{targetDirectoryPath:y}=(0,d.$)(),[j,D]=(0,m.useState)(!1),F=(0,m.useRef)(null),b=(0,m.useRef)(null),k=(0,u.A)(),[R,w]=(0,m.useReducer)(e=>e+1,0,void 0),E=!y;function I(e){return t?t+e:e}(0,m.useEffect)(()=>{!k&&b.current&&F.current&&(b.current.value=l,F.current.value=i)},[l,i]),(0,m.useEffect)(()=>{v(j)},[j]);return(0,r.jsxs)(g.A,{container:!0,spacing:1,children:[(0,r.jsxs)(f.A,{fullWidth:!0,error:j,children:[(0,r.jsx)(c.A,{inputRef:b,error:j,name:"entryName",label:A("core:fileName"),onChange:e=>{T(e.target.value),(e=>{let t=(0,s.Bj)(e);t?j!==t?D(t):w():D(t)})(e.target.value)},onFocus:e=>{if(l){e.preventDefault();const{target:t}=e;t.focus();let n=l.length;t.setSelectionRange(0,n)}},onKeyDown:e=>{"Enter"!==e.key&&"Enter"!==e.code||(e.preventDefault(),e.stopPropagation(),a(n))},defaultValue:l,disabled:E,autoFocus:!0,"data-tid":I("newEntryDialogInputTID")}),j&&(0,r.jsx)(h.A,{children:A("core:fileNameHelp")})]}),n?(0,r.jsx)(f.A,{fullWidth:!0,children:(0,r.jsx)(c.A,{autoFocus:!0,id:"fileContentID",label:A("core:fileContent"),multiline:!0,rows:5,inputRef:F,defaultValue:i,onChange:e=>{C(e.target.value)}})}):(0,r.jsxs)(p.A,{style:{margin:"0 auto"},children:[(0,r.jsx)(o.A,{tooltip:A("createMarkdownTitle"),onClick:()=>a("md"),"data-tid":I("createMarkdownButton"),disabled:E,style:{borderTopRightRadius:0,borderBottomRightRadius:0,fontWeight:"bold"},children:A("createMarkdown")}),(0,r.jsx)(o.A,{tooltip:A("createNoteTitle"),onClick:()=>a("html"),"data-tid":I("createRichTextFileButton"),disabled:E,style:{borderRadius:0},children:A("createRichTextFile")}),(0,r.jsx)(o.A,{tooltip:A("createTextFileTitle"),onClick:()=>a("txt"),"data-tid":I("createTextFileButton"),disabled:E,style:{borderTopLeftRadius:0,borderBottomLeftRadius:0},children:A("createTextFile")})]})]})},C=function(e){const{tidPrefix:t,createFile:n,fileName:a,handleFileNameChange:l,handleFileContentChange:i,haveError:o,urlInputError:u}=e,{t:p}=(0,x.Bd)(),{targetDirectoryPath:T}=(0,d.$)(),[C,v]=(0,m.useState)(!1),[A,y]=(0,m.useState)(!1),[j,D]=(0,m.useReducer)(e=>e+1,0,void 0),F=!T;(0,m.useEffect)(()=>{o(C||A)},[C,A]);return(0,r.jsxs)(g.A,{container:!0,spacing:1,children:[(0,r.jsxs)(f.A,{fullWidth:!0,error:C,children:[(0,r.jsx)(c.A,{error:C,name:"entryName",label:p("core:fileName"),onChange:e=>{var t;l(e.target.value),(t=(0,s.Bj)(e.target.value))?C!==t?v(t):D():v(t)},onFocus:e=>{if(a){e.preventDefault();const{target:t}=e;t.focus();let n=a.length;t.setSelectionRange(0,n)}},onKeyDown:e=>{"Enter"!==e.key&&"Enter"!==e.code||(e.preventDefault(),e.stopPropagation(),n("url"))},defaultValue:a,disabled:F,"data-tid":(b="newEntryDialogInputTID",t?t+b:b)}),C&&(0,r.jsx)(h.A,{children:p("core:fileNameHelp")})]}),(0,r.jsxs)(f.A,{fullWidth:!0,error:A||!!u,children:[(0,r.jsx)(c.A,{autoFocus:!0,error:A||!!u,id:"fileLinkID",placeholder:"e.g. https://wikipedia.org",label:p("core:linkURL"),onChange:e=>{var t;i(e.target.value),(t=!(0,s.Pv)(e.target.value))?A!==t?y(t):D():y(t)}}),A&&(0,r.jsx)(h.A,{children:p("core:urlValidationHelp")}),u&&(0,r.jsx)(h.A,{children:u})]})]});var b};var v=n(60341),A=n(76365),y=n(45575),j=n(34120),D=n(70704),F=n(14562),b=n(22013),k=n(19825),R=n(55370),w=n(25418),E=n(49565),I=n(53356),N=n(22944),P=n(67172),L=n(61741),B=n(69733),S=n(14970);const W=function(e){const{open:t,onClose:n,fileType:c,fileName:s}=e,{t:f}=(0,x.Bd)(),{createFileAdvanced:p}=(0,b.s)(),{findLocation:h,openLocation:g,getFirstRWLocation:W}=(0,D.L)(),{currentDirectoryPath:$}=(0,F.L)(),{targetDirectoryPath:U}=(0,d.$)(),M=(0,m.useRef)(!1),O=(0,m.useRef)(void 0),V=(0,B.d4)(S.kn),H=W(),K=k.C?.contextProviders?.FileTemplatesContext?(0,m.useContext)(k.C.contextProviders.FileTemplatesContext):void 0,[Y,_]=(0,m.useReducer)(e=>e+1,0,void 0),X=(0,I.A)(),q=(0,N.A)(X.breakpoints.down("md")),z=K?.getTemplate(c),G=(0,m.useRef)(Z()),J=(0,m.useRef)(ee()),Q=(0,u.A)();function Z(){if(s)return s+a.A.beginTagContainer+(0,P.formatDateTime4Tag)(new Date,!0)+a.A.endTagContainer;const e=z??window.ExtDefaultFileTemplate;return e&&void 0!==e.fileNameTmpl?e.fileNameTmpl.replace("{timestamp}",(0,P.formatDateTime4Tag)(new Date,!0)).replace("{uuid}",(0,l.getUuid)()):("url"===c?"link":"note")+a.A.beginTagContainer+(0,P.formatDateTime4Tag)(new Date,!0)+a.A.endTagContainer}function ee(){if("url"===c)return"";const e=z??window.ExtDefaultFileTemplate;if(e&&e.content){const t=(new Date).toISOString().split("T");return("html"===c?"\n<br />\n":" \n\n")+e.content.replace("{createdInApp}",`${f("core:createdIn")} ${L.UU}`).replace("{date}",t[0]).replace("{author}",V).replace("{time}",t[1].split(".")[0])}return`${f("core:createdIn")} ${L.UU} (`+(new Date).toISOString().split("T")[0]+")"}function te(e,t){t&&("url"!==e||J.current?(function(){const e=h();e&&e.type===P.locationType.TYPE_CLOUD||$||!H||g(H)}(),p(t,G.current,J.current,e),n()):(M.current=!0,O.current=f("core:emptyLink"),_()))}(0,m.useEffect)(()=>{!Q&&z&&G.current&&J.current&&(G.current=Z(),J.current=ee(),_())},[z]);const ne=(0,r.jsx)(o.A,{"data-tid":"createTID",variant:"contained",onClick:()=>{te(c,U)},disabled:M.current,style:{WebkitAppRegion:"no-drag"},children:f("core:ok")});return(0,r.jsxs)(R.A,{open:t,onClose:n,fullScreen:q,keepMounted:!0,"aria-labelledby":"draggable-dialog-title",PaperComponent:q?E.A:i.A,scroll:"paper",children:[(0,r.jsx)(j.A,{dialogTitle:f("txt"===c?"createTXTFile":"md"===c?"createMarkdown":"html"===c?"createRichTextFile":"url"===c?"createLinkFile":"newFileNote"),onClose:n,closeButtonTestId:"closeNewFileDialogTID",actionSlot:ne}),(0,r.jsxs)(w.A,{style:{paddingTop:10,minWidth:200,overflow:"overlay"},"data-tid":"newFileDialog",children:["url"===c?(0,r.jsx)(C,{createFile:e=>te(e,U),handleFileNameChange:e=>G.current=e,handleFileContentChange:e=>J.current=e,haveError:e=>{M.current=e,O.current="",_()},urlInputError:O.current,fileName:G.current}):(0,r.jsx)(T,{fileType:c,createFile:e=>te(e,U),handleFileNameChange:e=>G.current=e,handleFileContentChange:e=>J.current=e,haveError:e=>{M.current=e,_()},fileName:G.current,fileContent:J.current}),(0,r.jsx)(A.A,{fileType:c,label:f("templatesTab")}),(0,r.jsx)(v.A,{})]}),!q&&c&&(0,r.jsxs)(y.A,{children:[(0,r.jsx)(o.A,{"data-tid":"backTID",onClick:()=>{n()},children:f("core:cancel")}),ne]})]})}},60341:(e,t,n)=>{n.d(t,{A:()=>u});var r=n(74848),a=n(32535),l=n(91133),i=n(70704),o=n(85342),c=n(35124),d=n(67172),s=n(32389);const u=function(){const{t:e}=(0,s.Bd)(),{findLocation:t}=(0,i.L)(),{targetDirectoryPath:n}=(0,l.$)(),u=t();return(0,r.jsx)(o.A,{container:!0,style:{marginTop:20},children:n?(0,r.jsxs)(c.A,{style:{display:"flex",alignItems:"center"},variant:"caption",children:[(0,r.jsx)(a.mo,{style:{paddingRight:10}}),e("core:entriesWillBeCreatedIn")+" "+(u?.type===d.locationType.TYPE_CLOUD?u.name+"/":"")+n]}):(0,r.jsx)(c.A,{variant:"caption",children:e("noSuitableLocation")})})}},76365:(e,t,n)=>{n.d(t,{A:()=>d});var r=n(74848),a=n(8039),l=n(19825),i=n(37603),o=n(96540),c=n(32389);const d=function(e){const{fileType:t,label:n,disabled:d=!1}=e,{t:s}=(0,c.Bd)(),u=l.C?.contextProviders?.FileTemplatesContext?(0,o.useContext)(l.C.contextProviders.FileTemplatesContext):void 0,f=u?.getTemplates();if("url"===t||!f)return null;const p=t?f.filter(e=>e.type===t):f.filter(e=>void 0===e.type);if(!p||p.length<2)return null;const h=n||s("defaultTemplate"+(t??""));return(0,r.jsx)(a.A,{"data-tid":"tagDelimiterTID",label:h,disabled:d,fullWidth:!0,value:u?.getTemplate(t)?.id,onChange:e=>u?.setTemplateActive(e.target.value),children:p.map((e,t)=>(0,r.jsx)(i.A,{value:e.id,children:e.name}))})}},91133:(e,t,n)=>{n.d(t,{$:()=>l});var r=n(96540),a=n(16845);const l=()=>(0,r.useContext)(a.O)}}]);
//# sourceMappingURL=6809.bundle.js.map