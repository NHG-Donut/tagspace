"use strict";(self.webpackChunktagspaces=self.webpackChunktagspaces||[]).push([[1900],{43008:(e,n,i)=>{i.r(n),i.d(n,{default:()=>E});var t=i(74848),r=i(96488),o=i(32535),a=i(50494),s=i(84952),l=i(20404),c=i(95150),d=i(66530),h=i(70704),p=i(14562),u=i(36749),x=i(69605),j=i(22013),A=i(45387),g=i(73989),f=i(19825),y=i(14970),m=i(32139),F=i(2788),k=i(3427),C=i(37603),v=i(51475),D=i(15548),M=i(12070),T=i(16738),S=i(77118),P=i(96540),b=i(32389),B=i(69733);const E=function(e){const{reorderTop:n,reorderBottom:i,anchorEl:E,mouseX:w,mouseY:I,open:O,onClose:L}=e,R=(0,B.d4)(y.oh),{t:N}=(0,b.Bd)(),{openAddRemoveTagsDialog:W,openMoveCopyFilesDialog:Q,openRenameEntryDialog:U,openShareFilesDialog:$}=(0,l.K)(),{selectedEntries:q,lastSelectedEntry:K}=(0,g._)(),{openDeleteMultipleEntriesDialog:Y}=(0,s.u)(),{setBackgroundImageChange:Z,setThumbnailImageChange:_,openFileNatively:G,duplicateFile:X,setFolderBackgroundPromise:z,downloadFsEntry:H,getMetadataID:J}=(0,u.E)(),{openEntry:V,openedEntry:ee,fileChanged:ne}=(0,j.s)(),{openDirectory:ie,currentLocationPath:te,getAllPropertiesPromise:re}=(0,p.L)(),{showNotification:oe}=(0,x.M)(),{setFolderThumbnailPromise:ae}=(0,A.U)(),{currentLocationId:se,currentLocation:le}=(0,h.L)(),ce=(0,P.useRef)(void 0),[de,he]=(0,P.useReducer)(e=>e+1,0,void 0);function pe(){const e=q[0].path,n=(0,F.Cd)(te,e);return J(q[0].path,q[0].uuid,le).then(e=>(0,S.generateSharingLink)(se,n,void 0,e))}(0,P.useEffect)(()=>{le?.haveObjectStoreSupport()&&K&&le.generateURLforPath(K.path,86400).then(e=>{ce.current=e,he()})},[se,K]);const ue=[],xe=K?.path.toLowerCase(),je=m.Zu.some(e=>xe?.endsWith("."+e));return q.length<2&&(ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuOpenFile",onClick:function(){if(L(),K)return V(K.path)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.yl,{})}),(0,t.jsx)(T.A,{primary:N("core:openFile")}),(0,t.jsx)(c.A,{keyBinding:R.openEntry})]},"fileMenuOpenFile")),ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuOpenFileNewWindow",onClick:function(){L(),q&&1===q.length&&pe().then(e=>{const n=window.location.href.split("?")[0]+"?"+e.split("?")[1];(0,F.SP)(n)})},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.K2,{})}),(0,t.jsx)(T.A,{primary:N("core:openInWindow")})]},"fileMenuOpenFileNewWindow")),ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuOpenParentFolderInternally",onClick:function(){if(L(),K){const e=(0,S.extractContainingDirectoryPath)(K.path,le?.getDirSeparator()),n=(0,S.extractParentDirectoryPath)(e,le?.getDirSeparator());return ie(n)}},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.SM,{})}),(0,t.jsx)(T.A,{primary:N("core:openParentFolder")})]},"fileMenuOpenParentFolderInternally"))),!(le&&(le.haveObjectStoreSupport()||le.haveWebDavSupport())||r.A.isWeb)&&q.length<2&&(ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuOpenFileNatively",onClick:function(){L(),K&&G(K.path)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.AQ,{})}),(0,t.jsx)(T.A,{primary:N("core:openFileNatively")}),(0,t.jsx)(c.A,{keyBinding:R.openFileExternally})]},"fileMenuOpenFileNatively")),r.A.isElectron&&ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuOpenContainingFolder",onClick:()=>{L(),K&&(0,F.TQ)(K.path)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.sj,{})}),(0,t.jsx)(T.A,{primary:N("core:showInFileManager")})]},"fileMenuOpenContainingFolder")),ue.push((0,t.jsx)(D.A,{},`divider-${ue.length}`))),le?.isReadOnly||(ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuAddRemoveTags",onClick:function(){L(),ee&&ne&&q&&q.some(e=>e.path===ee.path)?oe(`You can't edit tags, because '${ee.path}' is opened for editing`,"default",!0):W(q)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.gq,{})}),(0,t.jsx)(T.A,{primary:N("core:addRemoveTags")}),(0,t.jsx)(c.A,{keyBinding:R.addRemoveTags})]},"fileMenuAddRemoveTags")),n&&ue.push((0,t.jsxs)(C.A,{"data-tid":"reorderTopTID",onClick:()=>{L(),n(K)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.Kp,{})}),(0,t.jsx)(T.A,{primary:N("core:moveToTop")})]},"reorderTop")),i&&ue.push((0,t.jsxs)(C.A,{"data-tid":"reorderBottomTID",onClick:()=>{L(),i(K)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.ZL,{})}),(0,t.jsx)(T.A,{primary:N("core:moveToBottom")})]},"reorderBottom")),ue.push((0,t.jsx)(D.A,{},`divider-${ue.length}`)),q.length<2&&(ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuRenameFile",onClick:function(){L(),U()},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.CF,{})}),(0,t.jsx)(T.A,{primary:N("core:renameFile")}),(0,t.jsx)(c.A,{keyBinding:R.renameFile})]},"fileMenuRenameFile")),ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuDuplicateFileTID",onClick:function(){L(),X(K.path)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.Gq,{})}),(0,t.jsx)(T.A,{primary:N("core:duplicateFile")}),(0,t.jsx)(c.A,{keyBinding:R.duplicateFile})]},"fileMenuDuplicateFile"))),f.C&&le?.haveObjectStoreSupport()&&$&&ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuShareFile",onClick:function(){L(),$()},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.li,{})}),(0,t.jsx)(T.A,{primary:N("core:shareFiles")})]},"fileMenuShareFile")),ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuMoveCopyFile",onClick:function(){L(),Q(q)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o._O,{})}),(0,t.jsx)(T.A,{primary:N("core:moveCopyFile")}),(0,t.jsx)(c.A,{keyBinding:R.copyMoveSelectedEntries})]},"fileMenuMoveCopyFile")),ue.push((0,t.jsxs)(C.A,{"data-tid":"fileMenuDeleteFile",onClick:function(){L(),Y()},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.d7,{})}),(0,t.jsx)(T.A,{primary:N("core:deleteEntry")}),(0,t.jsx)(c.A,{keyBinding:R.deleteDocument})]},"fileMenuDeleteFile")),ue.push((0,t.jsx)(D.A,{},`divider-${ue.length}`)),f.C&&q.length<2&&(ue.push((0,t.jsxs)(C.A,{"data-tid":"setAsThumbTID",onClick:function(){L(),ae(K.path).then(e=>(re((0,S.extractContainingDirectoryPath)(K.path),K.locationID).then(n=>{_({...n,meta:{...n.meta,thumbPath:e}})}),!0)).catch(e=>(oe("Thumbnail creation failed."),console.log("Error setting Thumb for entry: "+K.path,e),!0))},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.Ql,{})}),(0,t.jsx)(T.A,{primary:N("core:setAsThumbnail")})]},"setAsThumbTID")),je&&ue.push((0,t.jsxs)(C.A,{"data-tid":"setAsBgndTID",onClick:()=>async function(){let e;L(),e=le&&(le.haveObjectStoreSupport()||le.haveWebDavSupport())?await le.generateURLforPath(K.path,604800):K.path;const n=(0,S.extractContainingDirectoryPath)(K.path,le?.getDirSeparator());z(e,n).then(e=>re(e)).then(e=>(Z(e),oe("Background created for: "+e.path),!0)).catch(e=>(oe("Background creation failed."),console.log("Error setting Background for entry: "+K.path,e),!0))}(),children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.Ql,{})}),(0,t.jsx)(T.A,{primary:N("core:setAsBackground")})]},"setAsBgndTID")))),1===q.length&&(ue.push((0,t.jsxs)(C.A,{"data-tid":"copyFileSharingLink",onClick:function(){L(),q&&1===q.length&&pe().then(e=>{const n=(0,S.extractTitle)(q[0].name,!q[0].isFile,le?.getDirSeparator()),i=(0,k.Q3)(e,n);navigator.clipboard.write(i).then(()=>(oe(N("core:sharingLinkCopied")),!0)).catch(e=>{console.log("Error copying to clipboard "+e),oe(N("core:sharingLinkFailed"))})})},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.qY,{})}),(0,t.jsx)(T.A,{primary:N("core:copySharingLink")})]},"copySharingLink")),ue.push((0,t.jsxs)(C.A,{"data-tid":"downloadFileUrlTID",onClick:()=>{if(q&&q.length>0){const e=q[q.length-1];le.checkFileEncryptedPromise(e.path).then(n=>{H({...e,isEncrypted:n})})}L()},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.s3,{})}),(0,t.jsx)(T.A,{primary:N("core:downloadFile")})]},"downloadFileUrl"))),q.length<2&&(ue.push((0,t.jsx)(D.A,{},`divider-${ue.length}`)),ue.push((0,t.jsxs)(C.A,{"data-tid":"showPropertiesTID",onClick:function(){L(),q&&1===q.length&&V(q[0].path,d.ob.propertiesTab)},children:[(0,t.jsx)(M.A,{children:(0,t.jsx)(o.Bx,{})}),(0,t.jsx)(T.A,{primary:N("core:filePropertiesTitle")}),(0,t.jsx)(c.A,{keyBinding:R.openEntryDetails})]},"showProperties"))),(0,t.jsx)(v.A,{anchorEl:E,anchorReference:I&&w?"anchorPosition":void 0,anchorPosition:I&&w?{top:I,left:w}:void 0,open:O,onClose:L,children:(0,t.jsx)(a.A,{children:ue})})}}}]);
//# sourceMappingURL=1900.bundle.js.map